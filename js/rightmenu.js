var strUrl;kk={},kk.showRightMenu=function(e,t=0,n=0){let o=$("#rightMenu");o.css("top",t+"px").css("left",n+"px"),e?o.show():o.hide()};var rigmtrue=!0,rmWidth=$("#rightMenu").width(),rmHeight=$("#rightMenu").height();function RemoveRightMenu(){kk.showRightMenu(!1),hideConsole(),$("#rightmenu-mask").attr("style","display: none")}function rswitchDarkMode(){RemoveRightMenu(),"light"==("dark"===document.documentElement.getAttribute("data-theme")?"dark":"light")?(activateDarkMode(),saveToLocal.set("theme","dark",2),void 0!==GLOBAL_CONFIG.Snackbar&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.day_to_night)):(activateLightMode(),saveToLocal.set("theme","light",2),void 0!==GLOBAL_CONFIG.Snackbar&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.night_to_day)),"function"==typeof utterancesTheme&&utterancesTheme(),"object"==typeof FB&&window.loadFBComment(),window.DISQUS&&document.getElementById("disqus_thread").children.length&&setTimeout((()=>window.disqusReset()),200)}function reference(e){if(e)document.getElementsByClassName("el-textarea__inner")[0].value="> "+e.toString().trim()+"\n>\n",document.getElementsByClassName("el-textarea__inner")[0].focus();else{var t=window.getSelection();document.getElementsByClassName("el-textarea__inner")[0].value="> "+t.toString().trim()+"\n>\n",document.getElementsByClassName("el-textarea__inner")[0].focus(),RemoveRightMenu()}}function rightMenuonsite(){document.querySelector("#search-button .search").click();var e=window.getSelection(),t=document.querySelector("#local-search-input input");let n=document.createEvent("HTMLEvents");n.initEvent("input",!0,!0),t.value=e.toString().trim(),t.dispatchEvent(n),RemoveRightMenu()}function rightMenubaidu(){var e="https://www.baidu.com/s?wd="+window.getSelection().toString().trim();document.getElementById("rightMenu-baidu").href=e,RemoveRightMenu()}function handlerClick(e){if(!document.getElementById("rightMenu").contains(e.target)){var t=document.querySelector("#rightMenu");"none"!=getComputedStyle(t,null).display&&RemoveRightMenu()}}kk.reloadrmSize=function(){rmWidth=$("#rightMenu").width(),rmHeight=$("#rightMenu").height()},window.oncontextmenu=function(e){let t=e.clientX+10,n=e.clientY;var o;return kk.reloadrmSize(),$(".rightMenu-group.hide").hide(),$("#menu-herf").hide(),$("#menu-music").hide(),musciPlayiS?$("#menu-music-stop").show():$("#menu-music-stop").hide(),$("#menu-other").show(),$("#other-share").show(),$("#ment-defl").show(),document.getSelection().toString()&&($("#menu-text").show(),document.getElementById("post-comment")?$("#rightMenu-reference").show():$("#rightMenu-reference").hide(),$("#menu-other").hide(),$("#other-share").hide()),"A"==(o=window.event.target).tagName&&null!=o.getAttribute("href")&&($("#menu-herf").show(),$("#menu-other").hide(),$("#other-share").hide(),strUrl=o.getAttribute("href")),function(){let t=!1;"YEOOE"==e.target.nodeName&&(t=!0,$("#menu-music").show(),$("#other-share").hide(),$("#menu-other").hide(),$("#ment-defl").hide());var n=e.target,o=(n.tagName,n.classList[0],n.id);"aplayer-played-id"!=o&&"aplayer-bar-id"!=o&&"aplayer-controller-id"!=o||(t=!0,$("#menu-music").show(),$("#other-share").hide(),$("#menu-other").hide(),$("#ment-defl").hide())}(),rigmtrue&&(kk.reloadrmSize(),rigmtrue=!1),t+rmWidth>window.innerWidth&&(t-=rmWidth+10),n+rmHeight>window.innerHeight&&(n-=n+rmHeight-window.innerHeight),kk.showRightMenu(!0,n,t),$("#rightmenu-mask").attr("style","display: flex"),!1},$("#menu-backward").on("click",(function(){window.history.back(),RemoveRightMenu()})),$("#menu-forward").on("click",(function(){window.history.forward(),RemoveRightMenu()})),$("#menu-refresh").on("click",(function(){window.location.reload()})),$("#menu-top").on("click",(function(){window.location.onclick=btf.scrollToDest(0,500),RemoveRightMenu()})),kk.copySelect=function(){document.execCommand("Copy",!1,null),RemoveRightMenu(),btf.snackbarShow("复制成功，复制和转载情标注本文地址")},$("#new-herf-window").on("click",(function(){document.getElementById("new-herf-window").href=strUrl,RemoveRightMenu()})),$("#new-herf-address").on("click",(function(){var e=document.createElement("input");document.body.appendChild(e),e.value=window.location.origin+strUrl,e.select(),document.execCommand("Copy"),document.body.removeChild(e),RemoveRightMenu(),btf.snackbarShow("已复制链接地址")})),$("#menu-share").on("click",(function(){var e=document.createElement("input");document.body.appendChild(e),e.value=window.location.href,e.select(),document.execCommand("Copy"),document.body.removeChild(e),btf.snackbarShow("复制本页链接地址成功"),RemoveRightMenu()})),document.addEventListener("click",handlerClick),$("#menu-translate").on("click",(function(){RemoveRightMenu(),document.querySelector("#translateLink").click()})),$("#menu-music-toggle").on("click",musicPlay),$("#menu-music-stop").on("click",musicStop),$("#menu-music-back").on("click",musicSkipBack),$("#menu-music-forward").on("click",musicSkipForward),$("#menu-music-copyMusicName").on("click",musicGetName);var musciPlayiS=!1,navMusic={navMusiceo:function(e=!0){if(e);else{let e=setInterval((()=>{document.querySelector("#nav-music .aplayer-pic")&&(clearInterval(e),navMusic.addNavMusicStatus())}),100)}},addNavMusicStatus:function(){const e=document.getElementById("nav-music");e.querySelector("#nav-music .aplayermusic").aplayer.on("loadeddata",(function(){})),e.querySelector("#nav-music .aplayermusic").aplayer.on("play",(function(){musciPlayiS=!0,$("#menu-music-toggle").hide(),RemoveRightMenu(),musiclrctrue(),document.querySelector(".aplayermusic").classList.remove("aplayer-narrow"),document.querySelector("#nav-music").classList.add("playing"),document.querySelector("#nav-music .aplayer-controller").setAttribute("id","aplayer-controller-id"),document.querySelector("#nav-music .aplayer-bar").setAttribute("id","aplayer-bar-id"),document.querySelector("#nav-music .aplayer-played").setAttribute("id","aplayer-played-id")})),e.querySelector("#nav-music .aplayermusic").aplayer.on("pause",(function(){musciPlayiS=!1,$("#menu-music-toggle").show(),RemoveRightMenu(),musiclrctrue(),document.querySelector(".aplayermusic").classList.add("aplayer-narrow"),document.querySelector("#nav-music").classList.remove("playing"),document.getElementById("nav-music-hoverTips").innerHTML="音乐已暂停",document.querySelector("#nav-music-hoverstop").classList.remove("showMusicStop"),document.querySelector("#nav-music .aplayer-controller").removeAttribute("id"),document.querySelector("#nav-music .aplayer-bar").removeAttribute("id"),document.querySelector("#nav-music .aplayer-played").removeAttribute("id")}))}};navMusic.navMusiceo(!1);var divert=!1;document.onmouseover=function(e){var t=e.target,n=t.id,o=(t.tagName,t.classList[0]);if("aplayermusic"!=o&&"aplayer-controller-id"!=n||(0==divert&&document.querySelector("#nav-music-hoverstop").classList.add("showMusicStop"),document.querySelector("#nav-music .aplayer-controller").removeAttribute("id"),t.onmouseleave=function(e){divert=!1,document.querySelector("#nav-music .aplayer-controller").setAttribute("id","aplayer-controller-id")}),"showMusicStop"==o||"nav-music-hoverstop"==n){var i=document.querySelector("#nav-music-hoverstop"),r=2,c=setInterval((function(){i.innerHTML=r+"s 后可拖动快进",--r<0&&(i.innerHTML="拖动快进",clearInterval(c),document.querySelector("#nav-music-hoverstop").classList.remove("showMusicStop"),divert=!0)}),1e3);t.onmouseleave=function(e){clearInterval(c),document.querySelector("#nav-music-hoverstop").classList.remove("showMusicStop"),i.innerHTML="3s 后可拖动快进"}}};var clknum=1;function musiclrctrue(){musciPlayiS?window.lrcs=window.setInterval((function(){var e=document.querySelector(".aplayermusic").getElementsByClassName("aplayer-title")[0].innerHTML.length,t=document.querySelector(".aplayermusic").getElementsByClassName("aplayer-author")[0].innerHTML.length;e>5||t>=10?document.querySelector("#nav-music").classList.add("titleleng"):document.querySelector("#nav-music").classList.remove("titleleng"),0==document.querySelector(".aplayermusic").getElementsByClassName("aplayer-lrc-contents")[0].getElementsByClassName("aplayer-lrc-current").length?document.querySelector("#nav-music").classList.add("lrcnull"):document.querySelector("#nav-music").classList.remove("lrcnull")}),100):window.clearInterval(lrcs)}function musicToggleBtn(){var e=document.querySelector("#nav-music-hoverTips");e.onmousedown=function(e){document.querySelector("#nav-music").classList.add("togglehove")},e.onmouseup=function(e){document.querySelector("#nav-music").classList.remove("togglehove")}}function musicToggle(){musciPlayiS?musicStop():musicPlay()}function musicPlay(){document.querySelector("#nav-music .aplayermusic").aplayer.toggle()}function musicStop(){document.querySelector("#nav-music .aplayermusic").aplayer.toggle()}function musicSkipBack(){RemoveRightMenu(),document.querySelector("#nav-music .aplayermusic").aplayer.skipBack()}function musicSkipForward(){RemoveRightMenu(),document.querySelector("#nav-music .aplayermusic").aplayer.skipForward()}function musicGetName(){RemoveRightMenu();for(var e=$(".aplayer-title"),t=[],n=e.length-1;n>=0;n--){t[n]=e[n].innerText;var o=document.createElement("input");document.body.appendChild(o),o.value=e[n].innerText,o.select(),document.execCommand("Copy"),document.body.removeChild(o),RemoveRightMenu()}return t[0]}document.onmousedown=function(e){if(0==e.button){var t=e.target,n=(t.tagName,t.classList[0],t.id);2==clknum?("aplayer-bar-id"!=n&&"aplayer-played-id"!=n&&"aplayer-controller-id"!=n||musciPlayiS&&musicStop(),clknum=1):("aplayer-controller-id"==n&&musciPlayiS&&musicStop(),clknum++),setTimeout((()=>{clknum=1}),200),"aplayer-bar-id"!=n&&"aplayer-played-id"!=n&&"aplayer-controller-id"!=n||(document.querySelector("#nav-music").classList.add("togglehove"),t.onmouseup=function(e){document.querySelector("#nav-music").classList.remove("togglehove")})}},musicToggleBtn();